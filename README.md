# ğŸ§  Stroke CT Classifier â€” EfficientNet-B3 Ensemble
A state-of-the-art deep-learning pipeline for **binary classification of Brain CT scans**  
(**Normal vs Stroke**) featuring advanced training strategies, strong regularization,  
and a production-ready Flask API.

---

## ğŸš€ Overview

This project provides a **complete end-to-end system** for training, evaluating, and deploying  
an EfficientNet-B3 model using:

- 5-fold cross-validation  
- Hard Negative Mining (HNM)  
- Focal Loss  
- Test-Time Augmentation (TTA)  
- Ensemble averaging  
- Flask inference API  
- Threshold tuning for clinical settings  

---

## âœ¨ Key Features

- ğŸ§© **EfficientNet-B3 (Noisy Student)** pretrained backbone  
- ğŸ”„ **5-fold ensemble** â†’ stable & reliable predictions  
- ğŸšï¸ **Optimized threshold**: `0.425` for best sensitivity/specificity  
- ğŸ§ª **TTA (H/V flips)** for better generalization  
- ğŸ¯ **Hard Negative Mining** at epoch 6  
- âš–ï¸ **Focal Loss** for imbalanced data  
- ğŸ“ˆ **Complete evaluation suite**: ROC, PR, OOF, CM  
- ğŸ”¥ **Grad-CAM support** for explainability  
- âš¡ **Lightweight & fast** deployment-ready API  

---

## ğŸ“Š Final Holdout Performance

| Metric | Score |
|--------|--------|
| **Accuracy** | **95.49%** |
| **ROC-AUC** | **0.9908** |
| **Optimal Threshold** | **0.425** |
| **Holdout Size** | **886 CT slices** |

### Class-wise Metrics

| Class | Description | Precision | Recall | F1-Score | Support |
|-------|-------------|-----------|--------|----------|---------|
| **0** | Normal | 0.9786 | 0.9300 | 0.9537 | 443 |
| **1** | Stroke | 0.9333 | 0.9797 | 0.9559 | 443 |

---

## ğŸ–¼ï¸ User Interface Preview  
A clean and simple interface for quick testing:

<img src="assets/userinterface.png" width="600">

---

## ğŸ§¾ Prediction Outcome Example  
Sample outcome generated by the API:

<img src="assets/outcome.png" width="600">

---

## ğŸ“ˆ Evaluation Plots

### ğŸ”¢ Confusion Matrix  
<img src="assets/confusion_matrix.png" width="550">

### ğŸ“‰ ROC Curve  
<img src="assets/roc_curve.png" width="550">

### ğŸ“Š Probability Distribution  
<img src="assets/prob_distribution.png" width="550">

---

## ğŸ§  Why This Model?

- âœ” **CNN-based end-to-end system**  
- âœ” **Modern EfficientNet-B3 backbone**  
- âœ” **TTA + Ensemble = high stability**  
- âœ” **False-negative minimization** via Focal Loss + HNM  
- âœ” **Explainable through Grad-CAM**  
- âœ” **Fast API suitable for production**  
- âœ” **Simpler, cleaner, and more scalable** than multi-CNN pipelines  

---
